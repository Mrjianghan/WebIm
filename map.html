<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
		<style type="text/css">
			body, html,#allmap {
				width: 100%;height: 100%;overflow: hidden;margin:0;font-family:"微软雅黑";
			}
		</style>
		<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=HIpuFBetnp1KKYrfcleBipO6x31IeI63"></script>
		<title>接收地理消息百度地图</title>
	</head>
	<body>
		<div id="allmap"></div>
		<script type="text/javascript">

			var str = window.location.search;

			var reg1 = /(\=)(.{1,30})(\&)/ig;

			var res1 = str.split(reg1);

			var reg2 = /(\=)/ig;

			var res2 = str.split(reg2);

			var lng = res1[2];
			var lat = res2[4];

			// 百度地图API功能
			//GPS坐标
			var x = lng;
			var y = lat;
			var ggPoint = new BMap.Point(x,y);

			//地图初始化
			var bm = new BMap.Map("allmap");
			bm.centerAndZoom(ggPoint, 18);
			bm.addControl(new BMap.NavigationControl());
			//坐标转换完之后的回调函数
			translateCallback = function (data){
			  if(data.status === 0) {
				var marker = new BMap.Marker(data.points[0]);
				bm.addOverlay(marker);
				bm.setCenter(data.points[0]);
				bm.enableScrollWheelZoom(true);
			  }
			}
			setTimeout(function(){
				var convertor = new BMap.Convertor();
				var pointArr = [];
				pointArr.push(ggPoint);
				convertor.translate(pointArr, 1, 5, translateCallback)
			}, 1000);
		</script>
	</body>
</html>

